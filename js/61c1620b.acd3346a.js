(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["61c1620b"],{"47b2":function(t,e,s){"use strict";s.r(e);var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"page"},[s("TitleBar",{attrs:{titleTx:t.title}}),t.haveRefered?t._e():s("q-input",{staticClass:"in-in-ma",attrs:{"float-label":"推荐人地址(只需填写一次)"},model:{value:t.toAddress,callback:function(e){t.toAddress=e},expression:"toAddress"}}),s("q-input",{staticClass:"in-in-ma",attrs:{"float-label":"投入金额ETH",type:"number"},model:{value:t.toAmt,callback:function(e){t.toAmt=e},expression:"toAmt"}}),s("span",{staticClass:"curt-balance"},[t._v("需要消耗:"+t._s(.01*t.toAmt/t.global.mcoinPrice)+" CMAT")]),s("q-btn",{staticClass:"btn-next",attrs:{label:"下一步",color:"primary"},on:{click:t.toNext}})],1)},a=[];n._withStripped=!0;s("6b54"),s("f559"),s("7514");var o=s("9bfb"),i=s("e7ea"),l=s("a002"),c=s.n(l),r=s("96a1"),h=s("3452"),d={components:{TitleBar:o["a"]},data:function(){return{currentBalance:this.global.wallet.lastEthbalance,title:"参与互助",toAddress:"",toAmt:"",canInvest:!0,haveRefered:this.$route.query.p1,investBmobId:""}},mounted:function(){var t=this;if("true"===this.global.investDistrice24){var e=Bmob.Query("invest");console.log(this.global.wallet.ethAddress),e.equalTo("address","==",this.global.wallet.ethAddress),e.find().then(function(e){console.log(e),0!==e.length&&(t.investBmobId=e[0].objectId,t.canInvest=(new Date).getTime()-e[0].time>=864e5)})}},methods:{bmobAddOrUpdate:function(){""===this.investBmobId?this.addAInvest():this.updateInvestTime(this.investBmobId)},updateInvestTime:function(t){var e=Bmob.Query("invest");e.set("id",t),e.set("time",(new Date).getTime()+""),e.save().then(function(t){}).catch(function(t){})},addAInvest:function(){var t=Bmob.Query("invest");t.set("address",this.global.wallet.ethAddress),t.set("time",(new Date).getTime()+""),t.save().then(function(t){console.log(t)}).catch(function(t){console.log(t)})},toNext:function(){var t=this,e=this;this.canInvest?""!==this.toAddress||this.haveRefered?this.toAddress!==this.global.wallet.ethAddress?this.toAddress.startsWith("0x")||this.haveRefered?this.toAmt>=this.global.config.minPerInvest&&this.toAmt<=this.global.config.maxPerInvest?this.toAmt>this.global.wallet.lastEthbalance?toast("你的ETH余额不足，请先转入足量ETH"):.01*this.toAmt/this.global.mcoinPrice>this.global.wallet.lastMcoinBalance?this.$q.dialog({title:"",message:"CMAT余额不足，请先购买相应数量的CMAT"}).then(function(){e.$router.push({path:"/ethtransfer",query:{p1:"CMAT",p2:t.global.wallet.lastMcoinBalance}})}).catch(function(){}):e.showPswdInputDialog():toast("单笔投入金额最少"+this.global.config.minPerInvest+"ETH,最多"+this.global.config.maxPerInvest+"ETH"):toast("请填写以0x开头的以太坊地址"):toast("推荐人不能填写自己哦"):toast("推荐人地址不能为空哦"):toast("同一账户24小时只能投资一次哦")},showPswdInputDialog:function(){var t=this;this.$q.dialog({title:this.itmeName1,message:"请输入你的钱包密码",prompt:{model:"",type:"text"},cancel:!0,color:"secondary"}).then(function(e){""===e?toast("密码不能为空哦"):(t.$q.loading.show({message:"正在提交交易，请稍后...",spinnerSize:50}),c.a.getItem("cryptMnemonic").then(function(s){null===s?(t.$q.loading.hide(),toast("当前没有可备份钱包，将跳到创建钱包页面"),t.$router.push("/walletfirst")):t.unlockWallet(s,e)}).catch(function(t){toast(t)}))}).catch(function(){})},unlockWallet:function(t,e){try{var s=h.AES.decrypt(t,e),n=s.toString(h.enc.Utf8),a=i["ethers"].Wallet.fromMnemonic(n),o=a.connect(this.global.defaultProvider);this.doInvest(o)}catch(t){console.log(t),toast("密码错误"),this.$q.loading.hide()}},doInvest:function(t){var e=this,s=this.global.m3gameContract.connect(t),n={value:i["ethers"].utils.parseEther(this.toAmt+"")};this.haveRefered?s.inverstAgain(n).then(function(t){console.log(t),e.$q.loading.hide(),e.showInfoDialog("已提交",t.hash),e.bmobAddOrUpdate()}):s.inverstFirst(this.toAddress,n).then(function(t){console.log(t),e.$q.loading.hide(),e.showInfoDialog("已提交",t.hash),e.bmobAddOrUpdate()})},showInfoDialog:function(t,e){var s=this;this.$q.dialog({title:t,message:"",ok:"查看结果",cancel:"关闭"}).then(function(){s.$router.go(-1),Object(r["a"])(s.global.etherscanio+"tx/"+e)}).catch(function(){s.$router.go(-1)})}}},u=d,f=(s("ea97"),s("2877")),g=Object(f["a"])(u,n,a,!1,null,null,null);g.options.__file="Invest.vue";e["default"]=g.exports},"6fd7":function(t,e,s){},"9bfb":function(t,e,s){"use strict";var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"title-bar"},[s("q-icon",{staticClass:"back-icon",attrs:{name:"navigate_before"},nativeOn:{click:function(e){return t.goBack(e)}}}),s("div",{staticClass:"title-tx"},[t._v(t._s(t.titleTx))])],1)},a=[];n._withStripped=!0;var o={props:["titleTx"],methods:{goBack:function(){this.$router.go(-1)}}},i=o,l=(s("a675"),s("2877")),c=Object(l["a"])(i,n,a,!1,null,null,null);c.options.__file="TitleBar.vue";e["a"]=c.exports},a675:function(t,e,s){"use strict";var n=s("ca51"),a=s.n(n);a.a},ca51:function(t,e,s){},ea97:function(t,e,s){"use strict";var n=s("6fd7"),a=s.n(n);a.a}}]);