(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["4deafd5a"],{"1e34":function(t,a,e){"use strict";e.r(a);var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"mypage"},[e("TitleBar",{attrs:{titleTx:t.title}}),e("div",{staticClass:"id-up-part"},[e("div",{staticClass:"id-di-sp"},[e("span",{staticClass:"id-di-name"},[t._v(t._s(t.$t("ivben"))+"：")]),e("span",{staticClass:"id-di-value"},[t._v(t._s(t.item.amt)+" ETH")])]),e("div",{staticClass:"id-di-sp"},[e("span",{staticClass:"id-di-name"},[t._v(t._s(t.$t("ivstartt"))+"：")]),e("span",{staticClass:"id-di-value"},[t._v(t._s(t.item.time))])]),e("div",{staticClass:"id-di-sp"},[e("span",{staticClass:"id-di-name"},[t._v(t._s(t.$t("ivprogress"))+"：")]),e("span",{staticClass:"id-di-value"},[t._v(t._s(t.pastTime))])]),e("div",{staticClass:"id-di-sp"},[e("span",{staticClass:"id-di-name"},[t._v(t._s(t.$t("curearned"))+"：")]),e("span",{staticClass:"id-di-value"},[t._v(t._s(t.currentIncome)+" ETH")])]),e("div",{staticClass:"id-di-sp"},[e("span",{staticClass:"id-di-name"},[t._v(t._s(t.$t("candraw"))+"：")]),e("span",{staticClass:"id-di-value"},[t._v(t._s(t.canDrawAmt)+" ETH")])]),t.currentWeek>=4&&t.isLive?e("span",{staticClass:"id-tips",domProps:{innerHTML:t._s(t.$t("repaytiptx",{leftCanDraw3:t.leftCanDraw3,bx4:t.bx4,iamt:t.dialogData.amt}))}}):t._e(),t.isLive?t._e():e("q-btn",{staticStyle:{"align-self":"center",margin:"10px"},attrs:{size:"18px",round:"",color:"secondary",icon:"done",disable:""}}),e("q-btn",{directives:[{name:"show",rawName:"v-show",value:t.nextBtnShow,expression:"nextBtnShow"}],staticClass:"btn-next",attrs:{rounded:"",label:t.$t("cansellheyue"),color:"primary"},on:{click:t.toNext}})],1),e("custom-input-dialog-vue",{attrs:{dialogData:t.dialogData},on:{pressOK:t.pressOK}}),e("div",{staticClass:"id-down-part"},[e("span",{staticClass:"id-transfer-tip"},[t._v(t._s(t.$t("drawlog")))]),e("div",{staticClass:"id-trans-log"},[e("q-list",{staticStyle:{width:"100vw"},attrs:{highlight:"",separator:"","no-border":""}},t._l(t.withdrawList,function(a,i){return e("q-item",{key:a.index,staticClass:"id-item",nativeOn:{click:function(e){t.openEtherScan(a.hash)}}},[e("span",{staticStyle:{color:"dodgerblue"}},[e("u",[t._v(t._s(a.withdrawamt)+" ETH")]),t.txStatus[i]?e("span",{staticStyle:{color:"red"}},[t._v(" Failed")]):t._e()]),e("span",{staticStyle:{color:"#44566B"}},[t._v(t._s(a.createdAt))])])}))],1)])],1)},s=[];i._withStripped=!0;e("c5f6"),e("96cf");var n=e("c973"),r=e.n(n),o=e("9bfb"),l=e("e7ea"),c=(e("a002"),e("6b45")),u=e("f5ef"),h=e("96a1"),d=(e("3452"),{components:{TitleBar:o["a"],CustomInputDialogVue:c["a"]},data:function(){return{title:this.$t("ivdetail"),item:this.$route.query.item,canDrawAmt:"",dialogData:{show:!1,msg:this.$t("cansellheyue"),from:"investDetail",leftCanDraw3:"",amt:"",w:0},alreadyDrawAmt:0,bx123:0,bx4:0,currentWeek:0,pastTime:"",currentIncome:"",leftCanDraw3:"",nextBtnShow:!0,spanTx:"",isLive:!0,withdrawList:[],txStatus:[]}},mounted:function(){this.getAlreadyDraw(this.$route.query.item.amt,this.$route.query.item.originTime,this.$route.query.item.investid),this.pastTime=this.getAlreadyPastTime(this.$route.query.item.originTime),this.currentIncome=this.getCurrentIncome(this.$route.query.item.amt,this.$route.query.item.originTime),this.checkOrderisFinal(),this.getInvestDrawBmob(this.$route.query.item.investid-1)},methods:{checkOrderisFinal:function(){var t=this,a=function(){var a=r()(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.global.m3gameContract.getStatus(t.$route.query.item.investid-1+"");case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}},a,this)}));return function(){return a.apply(this,arguments)}}();a().then(function(a){!1===a&&(t.isLive=!1,t.nextBtnShow=!1,t.canDrawAmt=0)})},getCurrentIncome:function(t,a){var e,i=parseInt((new Date).getTime()/1e3),s=parseInt((i-a)/60/60/this.global.cmatconfig.intervalHours/7),n=parseInt((i-a)/60/60/this.global.cmatconfig.intervalHours-7*s),r=this.global.cmatconfig.week1Ratio/1e4,o=this.global.cmatconfig.week2Ratio/1e4,l=this.global.cmatconfig.week3Ratio/1e4,c=this.global.cmatconfig.week4Ratio/1e4;switch(s){case 0:e=t*r*n;break;case 1:e=t*r*7+t*(1+7*r)*.5*o*n;break;case 2:e=t*r*7+t*(1+7*r)*.5*o*7+t*(1+7*r)*.5*(1+7*o)*.5*l*n;break;case 3:e=t*r*7+t*(1+7*r)*.5*o*7+t*(1+7*r)*.5*(1+7*o)*.5*l*7+t*(1+7*r)*.5*(1+7*o)*.5*(1+7*l)*.5*c*n;break;default:e=t*(1+7*r)*.5+t*(1+7*r)*.5*(1+7*o)*.5+t*(1+7*r)*.5*(1+7*o)*.5*(1+7*l)*.5+t*(1+7*r)*.5*(1+7*o)*.5*(1+7*l)*.5*(1+7*c)-t;break}return Number(e).toFixed(4)},getAlreadyDraw:function(t,a,e){var i=this,s=function(){var t=r()(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,i.global.m3gameContract.tAlreadyDrawById(i.global.wallet.ethAddress,e-1+"");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}();s().then(function(e){i.alreadyDrawAmt=l["ethers"].utils.formatEther(e);var s=i.computeCanDraw(t,a,i.alreadyDrawAmt);i.canDrawAmt=Number(s-5e-5>0?s-5e-5:s).toFixed(4),i.dialogData.canDrawAmt=i.canDrawAmt})},computeCanDraw:function(t,a,e){console.log("........开始.........."),console.log("amt:"+t+",time:"+a+"alreadyDraw:"+e);var i=this.global.cmatconfig.week1Ratio/1e4,s=this.global.cmatconfig.week2Ratio/1e4,n=this.global.cmatconfig.week3Ratio/1e4,r=this.global.cmatconfig.week4Ratio/1e4,o=parseInt((new Date).getTime()/1e3),l=parseInt((o-a)/60/60/this.global.cmatconfig.intervalHours/7),c=(parseInt((o-a)/60/60/this.global.cmatconfig.intervalHours-7*l),t*(1+7*i)*.5),u=c*(1+7*s)*.5,h=u*(1+7*n)*.5;this.bx123=c+u+h;var d=h*(1+7*r);switch(this.leftCanDraw3=Number(this.bx123-this.alreadyDrawAmt-5e-5).toFixed(4),this.leftCanDraw3="-0.0000"===this.leftCanDraw3?"0.0000":this.leftCanDraw3,this.dialogData.leftCanDraw3=this.leftCanDraw3,this.bx4=Number(d).toFixed(4),this.dialogData.amt=t,this.currentWeek=this.dialogData.w=l,console.log(l),console.log("........结束.........."),l){case 0:return 0;case 1:return c-e;case 2:return c+u-e;case 3:return c+u+h-e;default:return c+u+h+d-e}},getAlreadyPastTime:function(t){var a=parseInt((new Date).getTime()/1e3),e=parseInt((a-t)/60/60/24/7),i=parseInt((a-t)/60/60/24-7*e),s=parseInt((a-t)/60/60-24*(7*e+i)),n=parseInt((a-t)/60-60*(24*(7*e+i)+s));return e>=4?this.$t("finished"):e+this.$t("w")+i+this.$t("d")+s+this.$t("h")+n+this.$t("m")},toNext:function(){0!==this.canDrawAmt?this.dialogData.show=!0:toast(this.$t("candraw0"))},pressOK:function(t){this.currentWeek>=4&&t.v1>this.leftCanDraw3?this.getLocalWallet(t,t.v3):this.getLocalWallet(t,0)},getLocalWallet:function(t,a){var e=this;this.$q.loading.show({message:e.$t("txsubmiting"),spinnerSize:50});var i=this.util.getWallet(e,t.v2);this.doWithDraw(i,t.v1,a)},doWithDraw:function(t,a,e){var i=this,s=this.global.m3gameContract.connect(t),n={value:l["ethers"].utils.parseEther(e+"")},r=parseInt(this.item.investid)-1;s.investWithdraw(r+"",l["ethers"].utils.parseEther(a+""),n).then(function(t){console.log(t),i.$q.loading.hide(),i.saveInvestDraw2Bmob(r,a,t.hash),i.util.showInfoDialog(i,t.hash,!0),i.util.listen4TxResult(i,t.hash,i.$t("drawsuccess"),i.$t("drawfailed"),function(){n.value>0&&u["a"].$emit("investSuccess")})}).catch(function(t){i.util.reprotError2Bmob(i,"investWithdraw",t,r+","+l["ethers"].utils.parseEther(a+"")+","+n.value),i.$q.loading.hide()})},saveInvestDraw2Bmob:function(t,a,e){this.$axios.post(this.global.apiconfig.BmobRestAPIUrl+"classes/investwithdraw",{address:this.global.wallet.ethAddress,investid:t+"",withdrawamt:a+"",hash:e},{headers:this.global.apiconfig.BmobRestAPIHeaders}).then(function(t){})},getInvestDrawBmob:function(t){var a=this,e={address:this.global.wallet.ethAddress,investid:t+""};this.$axios.get(this.global.apiconfig.BmobRestAPIUrl+"classes/investwithdraw?where="+encodeURI(JSON.stringify(e)),{headers:this.global.apiconfig.BmobRestAPIHeaders}).then(function(t){a.withdrawList=t.data.results.reverse();for(var e=0;e<a.withdrawList.length;e++)a.getTxResult(e,a.withdrawList[e].hash)})},getTxResult:function(t,a){var e=this,i="https://api.etherscan.io/api?module=transaction&action=gettxreceiptstatus&txhash="+a+"&apikey="+this.global.apiconfig.etherscanAPIKey;this.$axios.get(i).then(function(a){"0"===a.data.status?e.txStatus[t]=!0:e.txStatus[t]=!1}).catch(function(t){}).then(function(){})},openEtherScan:function(t){Object(h["a"])(this.global.apiconfig.etherscanio+"tx/"+t)}}}),p=d,m=(e("5e9e"),e("2877")),f=Object(m["a"])(p,i,s,!1,null,null,null);f.options.__file="InvestDetail.vue";a["default"]=f.exports},"3dd4":function(t,a,e){},"5e9e":function(t,a,e){"use strict";var i=e("3dd4"),s=e.n(i);s.a},"6b45":function(t,a,e){"use strict";var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("q-dialog",{on:{cancel:t.onCancel,show:t.onShow,hide:t.onHide},scopedSlots:t._u([{key:"buttons",fn:function(a){return e("div",{staticClass:"dialog-btn"},[e("q-btn",{attrs:{flat:"",label:t.$t("cancel")},on:{click:a.cancel}}),e("q-btn",{staticStyle:{"margin-top":"0px"},attrs:{flat:"",label:t.$t("ok")},on:{click:t.onOk}})],1)}}]),model:{value:t.dialogData.show,callback:function(a){t.$set(t.dialogData,"show",a)},expression:"dialogData.show"}},[e("span",{staticStyle:{color:"black"},attrs:{slot:"message"},slot:"message"},[t._v(t._s(t.dialogData.msg))]),e("div",{attrs:{slot:"body"},slot:"body"},[e("q-input",{attrs:{type:"number",placeholder:"ethtrans"===t.dialogData.from?t.$t("inputbyamt"):"investDetail"===t.dialogData.from?t.$t("fillsellamt"):t.$t("drawamt")},model:{value:t.input1,callback:function(a){t.input1=a},expression:"input1"}}),e("q-input",{directives:[{name:"show",rawName:"v-show",value:t.cpuRepayShow,expression:"cpuRepayShow"}],attrs:{type:"number",placeholder:t.$t("repayamt")},model:{value:t.repayAmt,callback:function(a){t.repayAmt=a},expression:"repayAmt"}}),"ethtrans"===t.dialogData.from?e("span",{staticStyle:{"font-size":"10px"}},[t._v(t._s(t.$t("cutprice"))+":"+t._s(t.global.cmatconfig.mcoinPrice)+","+t._s(t.$t("payethnum",{num:t.input1*t.global.cmatconfig.mcoinPrice})))]):t._e(),e("q-input",{attrs:{placeholder:t.$t("enterpswd")},model:{value:t.input2,callback:function(a){t.input2=a},expression:"input2"}})],1)])},s=[];i._withStripped=!0;e("96cf");var n=e("c973"),r=e.n(n),o={props:["dialogData"],data:function(){return{input1:"investDetail"===this.dialogData.from?this.dialogData.canDrawAmt:"",input2:"",repayAmt:""}},computed:{cpuRepayShow:function(){return this.input1>this.dialogData.leftCanDraw3&&this.dialogData.w>=4},repayAmtTip:function(){return this.dialogData.amt}},methods:{onOk:function(){var t=this;if(""!==this.input1&&null!==this.input1)if(""!==this.input2)if(this.input2.length<6)toast(this.$t("pwsdless6"));else if("investDetail"===this.dialogData.from&&this.input1>this.dialogData.canDrawAmt)toast(this.$t("drawexceed"));else if(this.cpuRepayShow&&this.repayAmt<this.dialogData.amt)toast(this.$t("repayinsuffit")+this.dialogData.amt);else if("referAwards"===this.dialogData.from&&this.input1>this.dialogData.referAwards)toast(this.$t("drawexceed"));else if("referAwards"===this.dialogData.from&&this.input1>this.dialogData.totalInvest)toast(this.$t("drawexdtalivst"));else{if(("investDetail"===this.dialogData.from||"referAwards"===this.dialogData.from)&&this.input1*(this.global.cmatconfig.handlingFee/1e4)/this.global.cmatconfig.mcoinPrice>this.global.wallet.lastMcoinBalance)return this.$q.dialog({title:"",message:this.$t("cmatinsuft"),ok:this.$t("ok")}).then(function(){t.$router.push({path:"/ethtransfer",query:{p1:"CMAT",p2:t.global.wallet.lastMcoinBalance}})}),void(this.dialogData.show=!1);this.$emit("pressOK",{v1:this.input1,v2:this.input2,v3:this.repayAmt}),this.dialogData.show=!1}else toast(this.$t("pswdnull"));else toast(this.$t("numnull"))},onCancel:function(){},onShow:function(){},onHide:function(){},choose:function(){var t=r()(regeneratorRuntime.mark(function t(a,e){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}},t,this)}));return function(a,e){return t.apply(this,arguments)}}()}},l=o,c=(e("d882"),e("2877")),u=Object(c["a"])(l,i,s,!1,null,"feb28202",null);u.options.__file="CustomInputDialog.vue";a["a"]=u.exports},"9bfb":function(t,a,e){"use strict";var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"title-bar"},[e("q-icon",{staticClass:"title-back-icon",attrs:{name:"navigate_before"},nativeOn:{click:function(a){return t.goBack(a)}}}),e("div",{staticClass:"title-tx"},[t._v(t._s(t.titleTx))])],1)},s=[];i._withStripped=!0;var n={props:["titleTx"],methods:{goBack:function(){this.$router.go(-1)}}},r=n,o=(e("a675"),e("2877")),l=Object(o["a"])(r,i,s,!1,null,null,null);l.options.__file="TitleBar.vue";a["a"]=l.exports},a675:function(t,a,e){"use strict";var i=e("ca51"),s=e.n(i);s.a},b70ac:function(t,a,e){},ca51:function(t,a,e){},d882:function(t,a,e){"use strict";var i=e("b70ac"),s=e.n(i);s.a},f5ef:function(t,a,e){"use strict";e.d(a,"a",function(){return s});var i=e("2b0e"),s=new i["a"]}}]);